{
    "Description": "This policy enables you to restrict the VM-sizes your organization can specify when deploying resources. To allow other VM-sizes, edit policy or exclude resourcegroup.",
    "DisplayName": "Bluestep - Allowed VM-sizes",
    "Metadata": {
        "version": "1.0.0",
        "category": "Compute"
    },
    "Mode": "Indexed",
    "Parameters": {
        "listOfAllowedSKUs": {
            "type": "Array",
            "metadata": {
                "description": "The list of size SKUs that can be specified for virtual machines.",
                "displayName": "Allowed Size SKUs",
                "strongType": "VMSKUs"
            }
        },
        "effect": {
            "type": "String",
            "metadata": {
                "displayName": "Effect",
                "description": "Enable or disable the execution of the policy"
            },
            "allowedValues": [
                "Deny",
                "Audit"
            ],
            "defaultValue": "Deny"
        }
    },
    "PolicyRule": {
        "if": {
            "allOf": [{
                    "field": "type",
                    "equals": "Microsoft.Compute/virtualMachines"
                },
                {
                    "not": {
                        "field": "Microsoft.Compute/virtualMachines/sku.name",
                        "in": "[parameters('listOfAllowedSKUs')]"
                    }
                }
            ]
        },
        "then": {
            "effect": "[parameters('effect')]"
        }
    }
}